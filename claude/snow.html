<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="ai.author" content="Claude">
	<meta name="ai.note" content="This file was generated by Claude.">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Falling Snowflakes - Claude版</title>
	<style>
		body { margin: 0; overflow: hidden; }
		canvas { display: block; }
	</style>
</head>
<body>
	<canvas id="snow"></canvas>
	<script>
		// Claudeによる雪のアニメーション
		// 風の影響、奥行き感、雪の結晶形状を表現
		const canvas = document.getElementById('snow');
		const ctx = canvas.getContext('2d');
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;

		let wind = 0;
		let windTarget = 0;

		class Snowflake {
			constructor() {
				this.reset();
				this.y = Math.random() * canvas.height;
			}

			reset() {
				this.x = Math.random() * canvas.width;
				this.y = -10;
				// 奥行きレイヤー(0~1): 小さい=遠い、大きい=近い
				this.depth = Math.random();
				this.size = this.depth * 3 + 1;
				this.speed = this.depth * 2 + 0.5;
				this.wobble = Math.random() * Math.PI * 2;
				this.wobbleSpeed = Math.random() * 0.02 + 0.01;
				this.opacity = this.depth * 0.5 + 0.3;
				this.rotation = Math.random() * Math.PI * 2;
				this.rotationSpeed = (Math.random() - 0.5) * 0.02;
			}

			update() {
				this.wobble += this.wobbleSpeed;
				this.rotation += this.rotationSpeed;
				this.x += Math.sin(this.wobble) * 0.5 + wind * this.depth;
				this.y += this.speed;

				if (this.y > canvas.height + 10) this.reset();
				if (this.x < -20) this.x = canvas.width + 20;
				if (this.x > canvas.width + 20) this.x = -20;
			}

			draw() {
				ctx.save();
				ctx.translate(this.x, this.y);
				ctx.rotate(this.rotation);
				ctx.globalAlpha = this.opacity;

				if (this.size > 2.5) {
					// 大きい雪は結晶形状
					this.drawCrystal();
				} else {
					// 小さい雪は円
					ctx.beginPath();
					ctx.arc(0, 0, this.size, 0, Math.PI * 2);
					ctx.fillStyle = '#fff';
					ctx.fill();
				}

				ctx.restore();
			}

			drawCrystal() {
				ctx.strokeStyle = '#fff';
				ctx.lineWidth = 0.8;
				const s = this.size;
				for (let i = 0; i < 6; i++) {
					const angle = (Math.PI / 3) * i;
					const ex = Math.cos(angle) * s;
					const ey = Math.sin(angle) * s;
					ctx.beginPath();
					ctx.moveTo(0, 0);
					ctx.lineTo(ex, ey);
					ctx.stroke();
					// 小さな枝
					const mx = ex * 0.6;
					const my = ey * 0.6;
					const branchAngle = angle + Math.PI / 6;
					ctx.beginPath();
					ctx.moveTo(mx, my);
					ctx.lineTo(mx + Math.cos(branchAngle) * s * 0.3, my + Math.sin(branchAngle) * s * 0.3);
					ctx.stroke();
				}
			}
		}

		const snowflakes = Array.from({ length: 300 }, () => new Snowflake());

		// グラデーション背景
		function drawBackground() {
			const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
			grad.addColorStop(0, '#0a1628');
			grad.addColorStop(0.7, '#1a2a4a');
			grad.addColorStop(1, '#2a3a5a');
			ctx.fillStyle = grad;
			ctx.fillRect(0, 0, canvas.width, canvas.height);
		}

		function animate() {
			// 風を緩やかに変化させる
			if (Math.random() < 0.01) {
				windTarget = (Math.random() - 0.5) * 3;
			}
			wind += (windTarget - wind) * 0.01;

			drawBackground();

			// 奥の雪から描画（ソート）
			snowflakes.sort((a, b) => a.depth - b.depth);
			for (const flake of snowflakes) {
				flake.update();
				flake.draw();
			}

			requestAnimationFrame(animate);
		}

		animate();

		window.addEventListener('resize', () => {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		});
	</script>
</body>
</html>
