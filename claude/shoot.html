<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="ai.author" content="Claude">
	<meta name="ai.note" content="This file was generated by Claude.">
	<title>Shooting Game - Claude版</title>
	<style>
		body { margin: 0; overflow: hidden; background: #000; }
		canvas { display: block; }
	</style>
</head>
<body>
	<canvas id="game"></canvas>
	<script>
		// Claudeによる横スクロールシューティング
		// パーティクル爆発、パワーアップ、星背景
		const canvas = document.getElementById('game');
		const ctx = canvas.getContext('2d');
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;

		const keys = {};
		window.addEventListener('keydown', e => { keys[e.key] = true; });
		window.addEventListener('keyup', e => { keys[e.key] = false; });

		const groundH = 40;

		// 星背景
		const stars = Array.from({ length: 100 }, () => ({
			x: Math.random() * canvas.width,
			y: Math.random() * (canvas.height - groundH),
			size: Math.random() * 2 + 0.5,
			speed: Math.random() * 0.5 + 0.2
		}));

		// プレイヤー
		const player = {
			x: 80, y: canvas.height / 2,
			w: 45, h: 20, speed: 5, alive: true,
			powerLevel: 1
		};

		const bullets = [];
		const enemies = [];
		const particles = [];
		const powerups = [];
		let score = 0;
		let bulletCD = 0;
		let spawnCD = 0;

		function spawnEnemy() {
			const type = Math.floor(Math.random() * 3);
			enemies.push({
				x: canvas.width + 30,
				y: Math.random() * (canvas.height - groundH - 40) + 20,
				w: 30, h: 30, type,
				hp: type + 1,
				counter: 0,
				speed: [2, 2.5, 3.5][type],
				color: ['#ff4444', '#4488ff', '#aa44ff'][type],
				points: [100, 200, 300][type]
			});
		}

		function explode(x, y, color) {
			for (let i = 0; i < 12; i++) {
				const angle = Math.random() * Math.PI * 2;
				const speed = Math.random() * 3 + 1;
				particles.push({
					x, y,
					vx: Math.cos(angle) * speed,
					vy: Math.sin(angle) * speed,
					life: 1,
					color
				});
			}
		}

		function update() {
			if (!player.alive) return;

			// プレイヤー移動
			if (keys['ArrowUp']) player.y -= player.speed;
			if (keys['ArrowDown']) player.y += player.speed;
			if (keys['ArrowLeft']) player.x -= player.speed;
			if (keys['ArrowRight']) player.x += player.speed;
			player.y = Math.max(10, Math.min(canvas.height - groundH - player.h, player.y));
			player.x = Math.max(10, Math.min(canvas.width - player.w, player.x));

			// 発射
			if (keys[' '] && bulletCD <= 0) {
				bullets.push({ x: player.x + player.w, y: player.y + player.h / 2, speed: 10 });
				if (player.powerLevel >= 2) {
					bullets.push({ x: player.x + player.w, y: player.y + 2, speed: 10 });
					bullets.push({ x: player.x + player.w, y: player.y + player.h - 2, speed: 10 });
				}
				bulletCD = player.powerLevel >= 2 ? 6 : 8;
			}
			if (bulletCD > 0) bulletCD--;

			// 弾更新
			for (let i = bullets.length - 1; i >= 0; i--) {
				bullets[i].x += bullets[i].speed;
				if (bullets[i].x > canvas.width) bullets.splice(i, 1);
			}

			// 敵スポーン
			spawnCD++;
			if (spawnCD > 40) { spawnEnemy(); spawnCD = 0; }

			// 敵更新
			for (let i = enemies.length - 1; i >= 0; i--) {
				const e = enemies[i];
				e.x -= e.speed;
				e.counter++;
				if (e.type === 0) e.y += Math.sin(e.counter * 0.05) * 1.5;
				else if (e.type === 1) e.y += Math.cos(e.counter * 0.03) * 2;

				if (e.x + e.w < 0) { enemies.splice(i, 1); continue; }

				// 弾との衝突
				for (let j = bullets.length - 1; j >= 0; j--) {
					const b = bullets[j];
					if (b.x > e.x && b.x < e.x + e.w && b.y > e.y && b.y < e.y + e.h) {
						bullets.splice(j, 1);
						e.hp--;
						if (e.hp <= 0) {
							score += e.points;
							explode(e.x + e.w / 2, e.y + e.h / 2, e.color);
							// パワーアップドロップ（10%）
							if (Math.random() < 0.1) {
								powerups.push({ x: e.x, y: e.y, w: 15, h: 15, speed: 1 });
							}
							enemies.splice(i, 1);
						}
						break;
					}
				}
			}

			// パワーアップ
			for (let i = powerups.length - 1; i >= 0; i--) {
				powerups[i].x -= powerups[i].speed;
				const p = powerups[i];
				if (p.x < -20) { powerups.splice(i, 1); continue; }
				if (player.x < p.x + p.w && player.x + player.w > p.x &&
					player.y < p.y + p.h && player.y + player.h > p.y) {
					player.powerLevel = Math.min(3, player.powerLevel + 1);
					powerups.splice(i, 1);
				}
			}

			// パーティクル
			for (let i = particles.length - 1; i >= 0; i--) {
				const p = particles[i];
				p.x += p.vx;
				p.y += p.vy;
				p.life -= 0.02;
				if (p.life <= 0) particles.splice(i, 1);
			}

			// 敵との衝突
			for (const e of enemies) {
				if (player.x < e.x + e.w && player.x + player.w > e.x &&
					player.y < e.y + e.h && player.y + player.h > e.y) {
					player.alive = false;
				}
			}

			// 地面衝突
			if (player.y + player.h > canvas.height - groundH) {
				player.alive = false;
			}
		}

		function draw() {
			ctx.fillStyle = '#000';
			ctx.fillRect(0, 0, canvas.width, canvas.height);

			// 星
			ctx.fillStyle = '#fff';
			for (const s of stars) {
				ctx.globalAlpha = 0.5 + Math.random() * 0.3;
				ctx.fillRect(s.x, s.y, s.size, s.size);
				s.x -= s.speed;
				if (s.x < 0) s.x = canvas.width;
			}
			ctx.globalAlpha = 1;

			// 地面
			ctx.fillStyle = '#553311';
			ctx.fillRect(0, canvas.height - groundH, canvas.width, groundH);

			// パワーアップ
			for (const p of powerups) {
				ctx.fillStyle = '#ffff00';
				ctx.fillRect(p.x, p.y, p.w, p.h);
				ctx.fillStyle = '#ff8800';
				ctx.font = '12px sans-serif';
				ctx.fillText('P', p.x + 3, p.y + 12);
			}

			// プレイヤー
			if (player.alive) {
				ctx.fillStyle = '#00ff66';
				ctx.beginPath();
				ctx.moveTo(player.x + player.w, player.y + player.h / 2);
				ctx.lineTo(player.x, player.y);
				ctx.lineTo(player.x + 8, player.y + player.h / 2);
				ctx.lineTo(player.x, player.y + player.h);
				ctx.closePath();
				ctx.fill();
				// エンジン炎
				ctx.fillStyle = Math.random() > 0.5 ? '#ff4400' : '#ffaa00';
				ctx.fillRect(player.x - 8, player.y + player.h / 2 - 3, 8, 6);
			}

			// 弾
			ctx.fillStyle = '#ffff00';
			for (const b of bullets) {
				ctx.fillRect(b.x, b.y - 1, 8, 2);
			}

			// 敵
			for (const e of enemies) {
				ctx.fillStyle = e.color;
				ctx.fillRect(e.x, e.y, e.w, e.h);
			}

			// パーティクル
			for (const p of particles) {
				ctx.globalAlpha = p.life;
				ctx.fillStyle = p.color;
				ctx.fillRect(p.x - 2, p.y - 2, 4, 4);
			}
			ctx.globalAlpha = 1;

			// HUD
			ctx.fillStyle = '#fff';
			ctx.font = '16px sans-serif';
			ctx.fillText('SPACE: 発射 / 矢印キー: 移動', 10, 25);
			ctx.fillText(`Score: ${score}`, 10, 50);
			ctx.fillText(`Power: ${'★'.repeat(player.powerLevel)}`, 10, 75);

			if (!player.alive) {
				ctx.fillStyle = 'rgba(0,0,0,0.7)';
				ctx.fillRect(0, 0, canvas.width, canvas.height);
				ctx.fillStyle = '#ff4444';
				ctx.font = '48px sans-serif';
				ctx.textAlign = 'center';
				ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2 - 20);
				ctx.fillStyle = '#fff';
				ctx.font = '24px sans-serif';
				ctx.fillText(`Score: ${score}`, canvas.width / 2, canvas.height / 2 + 30);
				ctx.textAlign = 'left';
			}
		}

		function gameLoop() {
			update();
			draw();
			requestAnimationFrame(gameLoop);
		}

		gameLoop();
	</script>
</body>
</html>
