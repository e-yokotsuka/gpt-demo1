<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="ai.author" content="Claude">
	<meta name="ai.note" content="This file was generated by Claude.">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Water Ripples Simulation Part.2 - Claude版</title>
	<style>
		body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
		canvas { display: block; }
	</style>
</head>
<body>
	<canvas id="canvas"></canvas>
	<script>
		// Claudeによる雨と波紋デモ Part.2
		// 水面に落ちた雨が波紋を作る
		const canvas = document.getElementById('canvas');
		const ctx = canvas.getContext('2d');
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;

		const waterLevel = canvas.height * 0.65;

		class Raindrop {
			constructor() {
				this.reset();
				this.y = Math.random() * waterLevel;
			}

			reset() {
				this.x = Math.random() * canvas.width;
				this.y = -5;
				this.speed = Math.random() * 6 + 4;
				this.opacity = Math.random() * 0.3 + 0.2;
				this.active = true;
			}

			update() {
				if (!this.active) return;
				this.y += this.speed;
				if (this.y >= waterLevel) {
					// 波紋を生成
					ripples.push(new Ripple(this.x, waterLevel));
					this.reset();
				}
			}

			draw() {
				if (!this.active) return;
				ctx.beginPath();
				ctx.moveTo(this.x, this.y);
				ctx.lineTo(this.x - 0.3, this.y + 8);
				ctx.strokeStyle = `rgba(150, 190, 240, ${this.opacity})`;
				ctx.lineWidth = 1.5;
				ctx.stroke();
			}
		}

		class Ripple {
			constructor(x, y) {
				this.x = x;
				this.y = y;
				this.radius = 0;
				this.maxRadius = Math.random() * 30 + 20;
				this.speed = Math.random() * 1.5 + 0.5;
				this.life = 1.0;
			}

			update() {
				this.radius += this.speed;
				this.life = 1 - this.radius / this.maxRadius;
			}

			draw() {
				if (this.life <= 0) return;
				// 楕円で水面の波紋を表現
				ctx.beginPath();
				ctx.ellipse(this.x, this.y, this.radius, this.radius * 0.3, 0, 0, Math.PI * 2);
				ctx.strokeStyle = `rgba(150, 200, 255, ${this.life * 0.6})`;
				ctx.lineWidth = 1.5;
				ctx.stroke();
			}

			isDead() {
				return this.life <= 0;
			}
		}

		const raindrops = Array.from({ length: 80 }, () => new Raindrop());
		const ripples = [];

		function drawScene() {
			// 空のグラデーション
			const skyGrad = ctx.createLinearGradient(0, 0, 0, waterLevel);
			skyGrad.addColorStop(0, '#1a2a3a');
			skyGrad.addColorStop(1, '#2c3e50');
			ctx.fillStyle = skyGrad;
			ctx.fillRect(0, 0, canvas.width, waterLevel);

			// 水面
			const waterGrad = ctx.createLinearGradient(0, waterLevel, 0, canvas.height);
			waterGrad.addColorStop(0, '#1a3a5a');
			waterGrad.addColorStop(1, '#0a1a2a');
			ctx.fillStyle = waterGrad;
			ctx.fillRect(0, waterLevel, canvas.width, canvas.height - waterLevel);
		}

		function animate() {
			drawScene();

			for (const drop of raindrops) {
				drop.update();
				drop.draw();
			}

			for (let i = ripples.length - 1; i >= 0; i--) {
				ripples[i].update();
				ripples[i].draw();
				if (ripples[i].isDead()) {
					ripples.splice(i, 1);
				}
			}

			requestAnimationFrame(animate);
		}

		animate();

		window.addEventListener('resize', () => {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		});
	</script>
</body>
</html>
