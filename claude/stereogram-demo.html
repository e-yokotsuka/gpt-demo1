<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="ai.author" content="Claude">
	<meta name="ai.note" content="This file was generated by Claude.">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Stereogram Demo - Claude版</title>
	<style>
		body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; }
		canvas { display: block; margin: 0 auto; }
		#info { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); color: #aaa; font-family: sans-serif; font-size: 14px; text-align: center; }
	</style>
</head>
<body>
	<div id="info">目をリラックスさせて、画面の奥を見るように焦点をずらしてみてください</div>
	<canvas id="canvas"></canvas>
	<script>
		// Claudeによるステレオグラム（ランダムドットステレオグラム）
		// 深度マップから3Dステレオグラムを生成
		const canvas = document.getElementById('canvas');
		const ctx = canvas.getContext('2d');
		const width = Math.min(window.innerWidth, 800);
		const height = Math.min(window.innerHeight - 40, 600);
		canvas.width = width;
		canvas.height = height;

		const stripWidth = 100;

		// 深度マップの生成（浮き出る円形）
		function createDepthMap() {
			const depthCanvas = document.createElement('canvas');
			depthCanvas.width = width;
			depthCanvas.height = height;
			const dCtx = depthCanvas.getContext('2d');

			dCtx.fillStyle = '#000';
			dCtx.fillRect(0, 0, width, height);

			// 中央に浮かぶ円
			const grad = dCtx.createRadialGradient(width / 2, height / 2, 0, width / 2, height / 2, 150);
			grad.addColorStop(0, 'rgb(80, 80, 80)');
			grad.addColorStop(1, 'rgb(0, 0, 0)');
			dCtx.fillStyle = grad;
			dCtx.beginPath();
			dCtx.arc(width / 2, height / 2, 150, 0, Math.PI * 2);
			dCtx.fill();

			// 小さな浮き出る四角
			dCtx.fillStyle = 'rgb(50, 50, 50)';
			dCtx.fillRect(width * 0.2, height * 0.3, 60, 60);
			dCtx.fillRect(width * 0.7, height * 0.6, 80, 80);

			return dCtx.getImageData(0, 0, width, height);
		}

		function generateStereogram() {
			const depthMap = createDepthMap();
			const imageData = ctx.createImageData(width, height);

			for (let y = 0; y < height; y++) {
				// ランダムパターンストリップ
				const strip = [];
				for (let x = 0; x < stripWidth; x++) {
					const r = Math.random() > 0.5 ? 200 + Math.random() * 55 : Math.random() * 55;
					const g = Math.random() > 0.5 ? 200 + Math.random() * 55 : Math.random() * 55;
					const b = Math.random() > 0.5 ? 200 + Math.random() * 55 : Math.random() * 55;
					strip.push([r, g, b]);
				}

				const row = new Array(width);

				// 最初のストリップをコピー
				for (let x = 0; x < stripWidth && x < width; x++) {
					row[x] = strip[x];
				}

				// ステレオグラム生成
				for (let x = stripWidth; x < width; x++) {
					const depthIdx = (y * width + x) * 4;
					const depth = depthMap.data[depthIdx] / 255;
					const shift = Math.floor(depth * 15);
					const srcX = x - stripWidth + shift;

					if (srcX >= 0 && srcX < width && row[srcX]) {
						row[x] = row[srcX];
					} else {
						row[x] = strip[x % stripWidth];
					}
				}

				for (let x = 0; x < width; x++) {
					const idx = (y * width + x) * 4;
					const color = row[x] || [0, 0, 0];
					imageData.data[idx] = color[0];
					imageData.data[idx + 1] = color[1];
					imageData.data[idx + 2] = color[2];
					imageData.data[idx + 3] = 255;
				}
			}

			ctx.putImageData(imageData, 0, 0);
		}

		generateStereogram();
	</script>
</body>
</html>
